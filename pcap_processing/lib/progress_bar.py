import sys
from subprocess import check_output


PROGRESSBAR_WIDTH = 40


def update_progress_bar(line_ctr, num_lines, out='stdout'):
    '''Updates progress bar'''
    if not num_lines:
        return None
    percent = float(line_ctr) / float(num_lines)
    num_pounds = int(percent * PROGRESSBAR_WIDTH)
    num_spaces = PROGRESSBAR_WIDTH - num_pounds
    if out == 'stderr':
        sys.stderr.write("[%s%s] (%.0f%%)\r" % ("#" * num_pounds,
                                            " " * num_spaces,
                                            percent * 100))
    else:
        sys.stdout.write("[%s%s] (%.0f%%)\r" % ("#" * num_pounds,
                                            " " * num_spaces,
                                            percent * 100))
    sys.stdout.flush()


def num_file_lines(filepath):
    '''Counts the number of lines of a file'''
    out = check_output(["wc", "-l", filepath])
    return long(out.split(' ')[0])

