import MySQLdb
import string
import sys
import pymongo


def ConnectDB(server, dbname, usr, pwd, sql_mode='SQL_MODE'):
    try:
        conn = MySQLdb.connect(host=server, user=usr, passwd=pwd, db=dbname,
                               charset='utf8')
        cursor = conn.cursor(MySQLdb.cursors.DictCursor)
        return cursor, conn
    except MySQLdb.Error, e:
        print "failed to connect to DB: %s"%(e)
        sys.exit (-1)


def connect_to_mongoDb(host, port, db, user, pwd):
    uri = 'mongodb://%s:%s@%s:%s/%s?authMechanism=SCRAM-SHA-1' % (user,
                                                                 pwd,
                                                                 host,
                                                                 port,
                                                                 db)
    try:
        conn = pymongo.MongoClient(uri)
        db_obj = conn[db]
    # except pymongo.errors.ConnectionFailure, e:
    #     print "Could not connect to MongoDB: %s" % e
    except e:
        print "Could not connect to MongoDB: %s" % e
    #
    return db_obj


def clean(data):
    if type(data) is int or type(data) is long or type(data) is float:
        return data
    if (data == "NULL") or (data is None) or (data == "") or (data == '-')\
        or (data == "(empty)"):
        return "NULL"

    data = data.rstrip().lstrip()
    data = filter(lambda x: x in string.printable, data)
    data = data.replace("'", "")
    data = "'"+data+"'"
    return data


def sclean(data):
    if (data == "NULL") or (data is None) or (data == "") or (data == '-')\
       or (data == "(empty)"):
        return None
    if isinstance(data, str):
        data = data.strip()
        data = filter(lambda x: x in string.printable, data)
        if data[0] in ["'", '"'] and data[-1] in ["'", '"']:
            return data
    return data

