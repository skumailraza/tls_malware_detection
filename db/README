##################################
######### Prerequisites   ########
##################################

1) The module requires the existence of a RUNS 
   table (see ../runs/insert_runs.py) which requires the existence of a FILES
   table (see ../files/insert_filestable.py)

2) The parse_bro_logs.py assumes that you have already installed two Bro 
   versions (2.2 and 2.3.1) on specific directories
   See below instructions on how to install both Bro versions

3) The parse_bro_logs.py assumes that you have already installed the 
   geoiplookup package. You can install it by doing:
      sudo apt-get install geoip-bin

4) The parse_bro_logs.py assumes that the pcaps names are the MD5 hashes of the
samples that generated the traffic


########################################
##### Installing Bro versions    #######
########################################

1) Install the prerequisites packages detailed in the Bro Web page:
   https://www.bro.org/sphinx/install/install.html#prerequisites
   
   You can install all the necessary dependencies at once:
   sudo apt-get install bison cmake flex g++ gdb make libmagic-dev libpcap-dev libgeoip-dev libssl-dev python-dev swig2.0 zlib1g-dev

2) Download the tarballs from Bro Web site:

   wget https://www.bro.org/downloads/bro-2.2.tar.gz
   wget https://www.bro.org/downloads/bro-2.3.1.tar.gz

3) Install Bro 2.2:
   cd bro-2.2
   ./configure --prefix=/usr/local/bro_2.2/
   make
   sudo make install

4) Install Bro 3.2.1:
   cd bro-2.3.1
   ./configure --prefix=/usr/local/bro_2.3.1/
   make
   sudo make install

5) (Optional) Installing an older Bro version to a newer OS 
   (e.g., Ubuntu 16.04) may be problematic. On my machine I had to add 
   the following line in my ~/.bashrc to make the above Bro versions to work:
      export BROMAGIC=/usr/share/misc/magic
   where the value of the variable was taken by executing:
       file --version
   and then reloading bashrc file:
       . ~/bashrc
